<!DOCTYPE html>
<html> 
  <head> 
        <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>  
	<title>Hobbinterface</title>
	<style type="text/css"> 
 
		table{
			border-spacing: 5px 5px;
		}
		hr{
			color: orange;
			height: 0px;
			border: 0px;
			border-bottom: 3px dashed orange;
		}
		td{
			vertical-align:top;
		}
		#scissors{
			position: relative;
			left: -765px;
			top: 26px;
		}
		.rtd{
			border: 1px solid black;
			background: #ffebc5;
			padding: 20px;
			border-radius: 10px;
                        line-height:200%;
		}
		.rtd a{ color: green; }

		.rtdFloating
                {
			border: 1px solid black;
			background: #ffebc5;
			padding: 20px;
			border-radius: 10px;
                        line-height:200%; 


                        cursor: move;
                        position: absolute;  
                        visibility:hidden;
		}   
		.rtdFloating a{ color: green; }

                 #marker
                {
                        
			height: 1px;
                }

                 #joystick
                {
                        position:absolute;
                }
	</style>
   <script type="text/javascript">  
   
   var centerX=51;
   var centerY=54;
   
   var speedMultiplier=0.01;  
   
   var deadZoneSize = 6; 
   var deadZoneLeft = centerX-deadZoneSize;
   var deadZoneUp = centerY-deadZoneSize;
   var deadZoneRight = centerX+deadZoneSize;
   var deadZoneBottom = centerY+deadZoneSize;

   var limitLeft = 25;
   var limitUp = 27;
   var limitRight = 75;
   var limitBottom = 78;
 
   var ledX = 5;
   var ledY = 5;

   function makeUniqueURLs()
   {  
     var links = document.links;
     var i = links.length;
     var randomnumber=Math.floor(Math.random()*100000);
     
     while (i--) 
     {
       if (links[i].href.indexOf("javascript") == -1) 
          { links[i].href = links[i].href+"&t="+randomnumber; }
     } 
   }

    function refreshFeed()
    {
      document.getElementById("videoFeed").style.visibility='visible';
    }

    function makeFeedVisible()
    {
      document.getElementById("videoFeed").style.visibility='visible';
    }

    function makeFeedInvisible()
    {
      document.getElementById("videoFeed").style.visibility='hidden';
    }
 
    function httpGet(theUrl)
    {
    var xmlHttp = null;

    xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, true ); //Second parameter is async
    xmlHttp.send( null );
    return xmlHttp.responseText;
    }
 
function allowDrop(ev)
{
 //ev.preventDefault();
  return true;
}

function drag(ev)
{
 ev.dataTransfer.setData("Text",ev.target.id);
}

function drop(ev)
{
  ev.preventDefault();
  var data=ev.dataTransfer.getData("Text");
  ev.target.appendChild(document.getElementById(data));
  return true;
} 

   </script>

  </head>
 <body onload="makeUniqueURLs();"> 
        <div class="rtdFloating" id="videoFeed" draggable="true" ondrop="drop(event)" ondragover="allowDrop(event)" ondragstart="drag(event)" >
            <table>
              <tr>
                <td width=300 ></td><td><a href="javascript:makeFeedInvisible();">x</a></td>
              </tr>
              <tr>
                <td colspan=2> 
                 <img src="feedNotReady.jpg" id="videoFeedImage"> <br/>
                </td>
              </tr>
              <tr>
               <td colspan=2>
                 <a href="javascript:refreshFeed();">Refresh</a>   
               </td>
              </tr>
           </table>
	</div> 


  <center>
	<img src="header.png"/>
	<img src="scissors.png" id="scissors"/>
	<hr />
	
   <table id="content">
    <tr>
      <td> 

       <!-- NESTED BOX START -->
       <table>
        <tr>
         <td>

	<div class="rtd">
          <strong>HEAD</strong><br/>
          <a href="controlpanel.html?head=left">  Head Left</a><br/>
          <a href="controlpanel.html?head=center">Head Center</a><br/>
          <a href="controlpanel.html?head=right"> Head Right</a><br/><br/>

          <a href="controlpanel.html?head=up">    Head Up</a><br/>
          <a href="controlpanel.html?head=middle">Head Middle</a><br/>
          <a href="controlpanel.html?head=down">  Head Down</a><br/> <br/>
	</div> 
        </td>
        <td>

	<div class="rtd">
        <strong>COMMANDS</strong><br/>
        <a href="controlpanel.html?robot=clearfloor">  Clear Floor </a><br/> 
        <a href="controlpanel.html?bring=aspirin">  Bring Aspirin </a><br/> 
        <a href="controlpanel.html?bring=sugar">  Bring Sugar </a><br/> 
        <a href="controlpanel.html?robot=learnobject">  Learn Object </a><br/> 
        <a href="controlpanel.html?robot=helpme">  Help me </a><br/> 
        <a href="controlpanel.html?scenario=moveto1">Move To Start</a><br/><br/>

        <a href="controlpanel.html?hand=calibrate">  Calibrate Hand</a><br/>
	</div>

        </td>
       </tr>
       <tr>
        <td colspan=2>
           <div class="rtd">
            <center>
              <strong>MOVEMENT</strong><br/><br/>
   
<!--  ------------------------------------------------------------------------------
      START OF:         THE HTML5 CANVAS CODE FOR MAKING THE JOYSTICK WORK 
      ------------------------------------------------------------------------------   -->
<canvas id="joypadCanvas" width="160" height="160"></canvas>
    <script>
         var canvas = document.getElementById('joypadCanvas');
         var context = canvas.getContext('2d');
         var joypadObj = new Image();
         var joystickObj = new Image();
         var lastMouseX = 0;
         var lastMouseY = 0;
         var mouseDown = false;



     function clearCanvas()
     {
       var context = canvas.getContext('2d');
       context.clearRect(0, 0, canvas.width, canvas.height); 
     }
 
      function getMousePos(canvas, evt) 
    {
        var rect = canvas.getBoundingClientRect();
        return {
          x: evt.clientX - rect.left,
          y: evt.clientY - rect.top
        };
      }

      function drawJoystick(canvas, x ,y , imageObj) 
      {
        var context = canvas.getContext('2d'); 
        clearCanvas(); 
        context.drawImage(joypadObj,  0 ,0);
        context.drawImage(joystickObj,  x ,y);
      }

      function drawActiveStatus(canvas, x,y, width , height , color )
      {
        context.beginPath();
        context.fillStyle = color;
        context.fillRect(x, y, width, height);
        context.strokeRect(x, y, width, height);
      }
 


     function joystickCallback(x,y)
     {
        var padding = 30;
        var canvas = document.getElementById('joypadCanvas');
        var context = canvas.getContext('2d');
        var joystickActiveSwitch = document.getElementById("joystickActiveSwitch").checked;
  
          if ( x < limitLeft )   { x = limitLeft; }
          if ( x > limitRight )  { x = limitRight; }
          if ( y < limitUp )     { y = limitUp; }
          if ( y > limitBottom ) { y = limitBottom; } 
          
          lastMouseX=x;
          lastMouseY=y;

          drawJoystick(canvas, x,y, joystickObj );
           
          if ( 
               ( ( x <= deadZoneLeft )||( x >= deadZoneRight ) ) ||
                ( ( y <= deadZoneUp )||( y >= deadZoneBottom ) ) 
             )    

          {
           var joyX = (x - centerX) * speedMultiplier;
           var joyY = (y - centerY) * speedMultiplier;
           
           joyX = (-1) * joyX;
           joyY = (-1) * joyY;

           if ( (mouseDown) && (joystickActiveSwitch) )
              {
                 //alert('Mouse '+x+','+y+'\n Joy : '+joyX+','+joyY);   
                 drawActiveStatus(canvas, ledX, ledY , ledX+5 , ledY+5 , "rgb(255,0,0)" );
                 var randomnumber=Math.floor(Math.random()*100000);
                 httpGet("controlpanel.html?body=joystick&x="+joyX+'&y='+joyY+"&t="+randomnumber);
                 mouseDown=false; 
              } else
              {   
                 drawActiveStatus(canvas, ledX, ledY , ledX+5 , ledY+5 , "rgb(0,255,0)" );
              } 
          } else
          {
                 drawActiveStatus(canvas, ledX, ledY , ledX+5 , ledY+5 , "rgb(0,0,255)" );
           if ( (mouseDown)&&(joystickActiveSwitch) )
              {
                 var randomnumber=Math.floor(Math.random()*100000);
                 httpGet("controlpanel.html?body=joystick&x=0&y=0&t="+randomnumber);
              }
                 mouseDown=false; 
          }
 
     }







      function init() 
    { 
        canvas.addEventListener('mousedown', function() { mouseDown = true; joystickCallback(lastMouseX,lastMouseY); }, false);
        canvas.addEventListener('mouseup', function() { mouseDown = false; }, false); 
        canvas.addEventListener('mousemove', function(evt) 
                                               { 
                                                 var mousePos = getMousePos(canvas, evt);  
                                                 joystickCallback(mousePos.x,mousePos.y); 
                                               }, false); 
    }


       joypadObj.onload = function() { context.drawImage(joypadObj, 0, 0); };
       joypadObj.src = 'joypad.png';


       joystickObj.onload = function() { context.drawImage(joystickObj, 52, 52); };
       joystickObj.src = 'joybtn.png';

       init();  

 </script>

<!--  ------------------------------------------------------------------------------
      END OF:           THE HTML5 CANVAS CODE FOR MAKING THE JOYSTICK WORK 
      ------------------------------------------------------------------------------   -->

                <br/> 
                <label><input id="joystickActiveSwitch" type="checkbox" >Joystick Active</label> <br/>
                <a href="controlpanel.html?body=stop">STOP ALL MOVEMENT</a>
            </center>
           </div> 
        </td>
       </tr>
       </table> 
       <!-- NESTED BOX END -->
      </td>
      <td> 

	<div class="rtd">
        <strong>GENERIC</strong><br/>
        <a href="controlpanel.html?robot=yes"> Yes </a> &nbsp; &nbsp; &nbsp; / &nbsp; &nbsp;
        <a href="controlpanel.html?robot=no">  No </a><br/>
        <a href="controlpanel.html?robot=cancel"> Cancel </a><br/>
        <a href="controlpanel.html?robot=reward"> Reward </a><br/>
        <a href="controlpanel.html?robot=wake">  Hear My Name (C_WAKEUP) </a><br/> 
	<br/>        
        <a href="controlpanel.html?robot=stop"> Wake Up (C_STOP) </a><br/>
        <a href="controlpanel.html?robot=sleep">  Sleep </a><br/> 
        <a href="controlpanel.html?robot=openmic"> Open Mic </a><br/>
        <a href="controlpanel.html?robot=closemic">  Close Mic </a><br/>
        <a href="controlpanel.html?robot=call">  Call to Room </a><br/>
        <a href="controlpanel.html?robot=settings"> Settings </a><br/> 
        <a href="javascript:makeFeedVisible();">View</a>  / <a href="javascript:makeFeedInvisible();">Hide</a> the Camera<br/> 
	</div>


	<div class="rtd">
        <strong>BODY</strong><br/>
        <a href="controlpanel.html?body=left">  Move Left </a><br/> 
        <a href="controlpanel.html?body=right">  Move Right </a><br/>
        <a href="controlpanel.html?body=forward">  Move Forward </a><br/>
        <a href="controlpanel.html?body=back">  Move Back </a><br/>
	</div><br/>


      </td>
      <td> 
	<div class="rtd">
        <strong>READY TO DRINK POSES</strong><br/>
        <a href="controlpanel.html?rtd=home">Pose Home</a><br/>
        <a href="controlpanel.html?rtd=almosthome">Pose Almost Home</a><br/>
        <a href="controlpanel.html?rtd=armatside">Pose Arm At Side</a><br/>
        <a href="controlpanel.html?rtd=lowerlearn">Pose Lower Learn</a><br/>
        <a href="controlpanel.html?rtd=tablepregrasp">Pose Table Pregrasp</a><br/>
        <a href="controlpanel.html?rtd=tablefinalgrasp">Pose Table Final Grasp</a><br/>
        <a href="controlpanel.html?rtd=trayprerelease">Pose Tray Pre Release</a><br/>
        <a href="controlpanel.html?rtd=trayrelease">Pose Tray Release</a><br/>
        <a href="controlpanel.html?rtd=clearfloorpregrasp">Pose Clear Floor Pregrasp</a><br/>
        <a href="controlpanel.html?rtd=clearfloorfinalgrasp">Pose Clear Floor Final Grasp</a><br/>
        <a href="controlpanel.html?rtd=cfaftergrasp">Pose Clear Floor After Grasp</a><br/>
        <strong>READY TO DRINK COMMANDS</strong><br/>
        <a href="controlpanel.html?rtd=opengripper">Open Gripper</a><br/>
        <a href="controlpanel.html?rtd=closegripper">Close Gripper</a><br/>
        <a href="controlpanel.html?rtd=closegripper">Disable All Axis</a><br/>
        <strong>READY TO DRINK SEQUENCES</strong><br/>
        <a href="controlpanel.html?rtd=graspfromtable">Grasp From the Table</a><br/>
        <a href="controlpanel.html?rtd=graspfromfloor">Grasp From the Floor</a><br/>
	</div><br/>
      </td>
    </tr>

    <!--tr>
      <td colspan=10> 
        <br/><br/> 
        &nbsp;
      </td>
    </tr-->

    <tr>
      <td colspan=10><center>
       <form action="controlpanel.html" accept-charset="utf-8" >
        Speech : <input type="text" name="say"> <input type="submit" value="Say It">
       </form></center>
      </td>
    </tr>




   </table>
	<br/>
	<hr/><br/>

	<a href="controlpanel.html?nothing=true"> <h3>Click here to refresh neutral url</h3></a>



  </center> 
 </body>
</html>

