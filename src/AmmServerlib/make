#!/bin/bash
  
red=$(printf "\033[31m")
green=$(printf "\033[32m") 
normal=$(printf "\033[m")

cd InputParser
./make
cd ..


echo "Compiling libAmmServerlib.a / Author : Ammar Qammaz"  
LIBNAME="libAmmServerlib.a"

if [ -e $LIBNAME ]
then
  rm $LIBNAME
fi   

# -O3 -fexpensive-optimizations
CFLAGS="-s -Os -fexpensive-optimizations"

gcc -c $CFLAGS main.c -o main.o
gcc -c $CFLAGS server_threads.c -o server_threads.o 
gcc -c $CFLAGS http_tools.c -o http_tools.o 
gcc -c $CFLAGS client_list.c -o client_list.o 
gcc -c $CFLAGS file_server.c -o file_server.o 
gcc -c $CFLAGS http_header_analysis.c -o http_header_analysis.o  
gcc -c $CFLAGS file_caching.c -o file_caching.o  
gcc -c $CFLAGS directory_lists.c -o directory_lists.o
gcc -c $CFLAGS server_configuration.c -o server_configuration.o  
gcc -c $CFLAGS time_provider.c -o time_provider.o 
gcc -c $CFLAGS InputParser/InputParser_C.c -o InputParser_C.o 
gcc -c $CFLAGS logs.c -o logs.o 

PARTS_OF_LIB="main.o server_threads.o http_tools.o client_list.o file_server.o http_header_analysis.o file_caching.o directory_lists.o server_configuration.o time_provider.o InputParser_C.o logs.o"

ar  rcs $LIBNAME $PARTS_OF_LIB

rm $PARTS_OF_LIB

if [ -e $LIBNAME ]
then
  echo "$green Success building $LIBNAME .. $normal"
else
  echo "$red Failure building $LIBNAME .. $normal"
fi



exit 0
