#!/bin/bash
 
echo "Compiling libAmmServerlib.a / Author : Ammar Qammaz"  
LIBNAME="libAmmServerlib.a"

if [ -e $LIBNAME ]
then
  rm $LIBNAME
fi   

# -O3 -fexpensive-optimizations
CFLAGS="-s"

gcc -c $CFLAGS main.c -o main.o
gcc -c $CFLAGS server_threads.c -o server_threads.o 
gcc -c $CFLAGS http_tools.c -o http_tools.o 
gcc -c $CFLAGS file_server.c -o file_server.o 
gcc -c $CFLAGS http_header_analysis.c -o http_header_analysis.o 
gcc -c $CFLAGS post_analyzer.c -o post_analyzer.o 
gcc -c $CFLAGS file_caching.c -o file_caching.o 
gcc -c $CFLAGS directory_lists.c -o directory_lists.o
gcc -c $CFLAGS configuration.c -o configuration.o  
gcc -c $CFLAGS time.c -o time.o 
gcc -c $CFLAGS logs.c -o logs.o 

PARTS_OF_LIB="main.o server_threads.o http_tools.o file_server.o http_header_analysis.o post_analyzer.o file_caching.o directory_lists.o configuration.o time.o logs.o"

ar  rcs $LIBNAME $PARTS_OF_LIB

rm $PARTS_OF_LIB

if [ -e $LIBNAME ]
then
  echo "Success.."
else
  echo "Failure.."
fi



exit 0